<style>
.chat
{
    list-style: none;
    margin: 0;
    padding: 0;
}

.chat li
{
    padding-top: 15px;
    padding-bottom: 15px;
    padding-left: 15px;
    padding-right: 15px;
}

.chat li:last-child
{
    border-bottom: none;
}

.chat li.left .chat-body
{
    margin-left: 60px;
}

.chat li.right .chat-body
{
    margin-right: 60px;
}


.chat li .chat-body p
{
    margin: 0;
    color: #777777;
}

.panel .slidedown .glyphicon, .chat .glyphicon
{
    margin-right: 5px;
}

.panel-body
{
    height: 225px;
}

.panel-body2
{
    height: 185px;
    margin: 15px;
}

.panel-body3
{
    margin: 15px;
}

.panel-body4
{
    margin: 15px;
}

::-webkit-scrollbar-track
{
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
    background-color: #F5F5F5;
}

::-webkit-scrollbar
{
    width: 12px;
    background-color: #F5F5F5;
}

::-webkit-scrollbar-thumb
{
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);
    background-color: #555;
}

p a {
    text-decoration: underline;
}

.twitter-typeahead {
    display: block !important;
}

.tt-dataset-topics {
    margin-left: 15px;
}

.help-buttons {
    margin-top: 15px;
}

img.mini{
  width: 30px;
  height: 30px;
}

@media (max-width: 768px) {
  img.mini{
    width: 100%;
    height: auto;
  }
}

textarea::-webkit-scrollbar {
width: 4px;
}

.datetime{
  font-size: 80%;
  padding: 3px!important;
  color: #AAA;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.datetime>span{
  position: relative;
  z-index: 3000;
}

li.error{
  color: #a94442;
  font-size: 80%;
}

</style>
<section id="mensajes">
  <div id="medico" class="container">
    <div class="profileBody">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-2">
              <div class="row">
              <div class="panel panel-default">
                <div class="panel-heading" style="padding:0px">
                  <div class="form-group has-feedback" style="margin-bottom: 0px;">
                    <input type="text" class="form-control" placeholder="Buscar contacto...">
                    <span class="glyphicon glyphicon-search form-control-feedback" aria-hidden="true"></span>
                  </div>
                </div>
                <div class="panel-body" style="padding:0px" id="contactList">
                  <table class="table table-hover table-bordered" style="margin:0px">
                    <tbody>
                      <tr>
                        <td onclick="cargarInbox('July Dooley')">
                          <img src="http://i.imgur.com/hsf4S3T.jpg" class="img-circle mini" width="50" height="50" />
                          <span class="hidden-xs">July DooleyDooley</span><br/>
                          <small class="pull-right text-right" style="font-size:70%;color:#888">Hace 3 horas <span style="font-size: 80%" class="glyphicon glyphicon-time" ></span></small>
                        </td>
                      </tr>
                      <tr>
                        <td onclick="cargarInbox('July Dooley')">
                          <img src="http://i.imgur.com/hsf4S3T.jpg" class="img-circle mini" width="50" height="50" />
                          <span class="hidden-xs">July Dooley</span><br/>
                          <small class="pull-right text-right" style="font-size:70%;color:#888">Hace 6 dias <span style="font-size: 80%" class="glyphicon glyphicon-time" ></span></small>

                        </td>
                      </tr>
                      <tr>
                        <td onclick="cargarInbox('July Dooley')">
                          <img src="http://i.imgur.com/hsf4S3T.jpg" class="img-circle mini" width="50" height="50" />
                          <span class="hidden-xs">July Dooley Dooley Dooley</span><br/>
                          <small class="pull-right text-right" style="font-size:70%;color:#888">El 23 de septiembre de 2015 <span style="font-size: 80%" class="glyphicon glyphicon-time" ></span></small>

                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            </div>
            <div class="col-lg-9 col-md-9 col-sm-9 col-xs-10">
              <div class="row">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title" id="InboxContact">Panel title</h3>
                </div>
                <div class="panel-body" id="InboxMsg" style="padding:0px;">
                  <ul class="chat" id="chat">

                        <li class="clearfix text-center" style="padding:0px;">
                          <button class="btn btn-warning btn-block">Cargar anteriores</button>
                        </li>

                        <li class="clearfix text-center datetime">
                          <span>
                            9 de octubre de 2015
                          </span>
                        </li>

                        <li class="right clearfix msg">
                          <span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                          </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Hi Jen! Laura has been missing deadlines for a few weeks and I'm having trouble motivating her to move faster.
                                </p>
                            </div>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="clearfix text-center datetime">
                          <span>
                            10 de octubre de 2015
                          </span>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="clearfix text-center datetime">
                          <span>
                            14 de octubre de 2015
                          </span>
                        </li>

                        <li class="left clearfix msg">
                          <span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                          </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="clearfix text-center datetime">
                          <span>
                            16 de octubre de 2015
                          </span>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="clearfix text-center datetime">
                          <span>
                            21 de octubre de 2015
                          </span>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                        Okay, so here's what's been happening...
                                            Okay, so here's what's been happening...
                                                Okay, so here's what's been happening...
                                                    Okay, so here's what's been happening...
                                                        Okay, so here's what's been happening...
                                                            Okay, so here's what's been happening...
                                                                Okay, so here's what's been happening...
                                                                    Okay, so here's what's been happening...
                                                                        Okay, so here's what's been happening...
                                                                            Okay, so here's what's been happening...
                                                                                Okay, so here's what's been happening...
                                                                                    Okay, so here's what's been happening...<br/><br/>
                                                                                        Okay, so here's what's been happening...
                                                                                            Okay, so here's what's been happening...
                                                                                                Okay, so here's what's been happening...<br/>
                                                                                                    Okay, so here's what's been happening...<br/>
                                                                                                        Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>


                        <li class="clearfix text-center datetime">
                          <span>
                            Ayer
                          </span>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>

                        <li class="right clearfix msg"><span class="chat-img pull-right">
                            <img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <small class=" text-muted"> </small>
                                    <strong class="pull-right primary-font">You</strong>
                                </div>
                                <p class="pull-right text-right">
                                    Okay, so here's what's been happening...
                                </p>
                            </div>
                        </li>

                        <li class="clearfix text-center datetime">
                          <div ></div>
                          <span>
                            Hoy
                          </span>
                        </li>

                        <li class="left clearfix msg"><span class="chat-img pull-left">
                            <img src="http://i.imgur.com/GYWbwhq.jpg" alt="User Avatar" class="img-circle" width="50" height="50" />
                        </span>
                            <div class="chat-body clearfix">
                                <div class="header">
                                    <strong class="primary-font">Jen Darby</strong>
                                    <small class="pull-right text-muted"> </small>
                                </div>
                                <p class="pull-left text-left">
                                    No problem, Tim! Let's look at <a href="">Laura's profile</a> together and come up with a plan.
                                </p>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="panel-footer" id="inboxInput">
                    <div class="input-group">
                        <textarea id="inboxInputText" rows="1" class="form-control input-sm" placeholder="Type your message here..."  onkeyup="auto_grow(this)" style="resize:none;overflow:auto;max-height:100px;"></textarea>
                        <span class="input-group-btn"><button class="btn btn-warning btn-sm" id="inboxBtnEnviar" style="max-height:100px;"><span class="glyphicon glyphicon-send"></span></button></span>
                    </div>
                </div>
              </div>
            </div>
          </div>
          </div>
        </div>
    </div>
  </div>
</section>

<script type="text/javascript">
    function auto_grow(element) {
      element.style.height = "5px";
      element.style.height = (element.scrollHeight + 2)+"px";
      $('#inboxBtnEnviar').css('height',element.style.height);
    }

    $("textarea").keypress(function(event) {
      var key = event.which || event.keyCode;
      var control = event.ctrlKey || event.altKey ||  event.shiftKey ;
      if (!control && key==13){
        if ($('#inboxInputText').val() != ''){
          if (enviarMensaje($('#InboxContact').html(), $('#inboxInputText').val())){
            $('#inboxInputText').val('');
          }
        }
        event.preventDefault();
      }
    });

    $('#inboxBtnEnviar').click(function(){
        if ($('#inboxInputText').val() != ''){
          $('#chat').append('  <li class="clearfix text-center error"><span><span class="glyphicon glyphicon-info-sign" style="font-size:80%"></span>imposible enviar el mensaje, por favor revisa tu conexion</span></li>');
          focusUltimo();
          setTimeout(function(){
            eliminarError();
          },3000);
          /*if (enviarMensaje($('#InboxContact').html(), $('#inboxInputText').val())){
            $('#inboxInputText').val('');
          }*/
        }
    });

    function eliminarError(){
      $('.error').fadeOut(300, function() { $(this).remove(); });
    }

    function focusUltimo(){
      var ultimoMsg = $( "#chat li" ).last();
      ultimoMsg[0].scrollIntoView();
    }

    function enviarMensaje(para, mensaje){
      eliminarError();
      var ultimoMsg = $( "#chat .msg" ).last();
      if (ultimoMsg.hasClass('right'))
        ultimoMsg.find('p').append('<br/>' + mensaje);
      else
        $('#chat').append('<li class="right clearfix msg" id="ultimo"><span class="chat-img pull-right"><img src="http://i.imgur.com/hsf4S3T.jpg" alt="User Avatar" class="img-circle" width="50" height="50" /></span><div class="chat-body clearfix"><div class="header"><small class=" text-muted"> </small><strong class="pull-right primary-font">You</strong></div><p class="pull-right text-right">'+ mensaje +'</p></div> </li>');
      focusUltimo();
      return true;
    }

    $(document).ready(function(){
      $('#InboxMsg').css('height',($(window).height() - document.getElementById('inboxInput').offsetHeight - document.getElementById('navPlatform').offsetHeight - 130));
      $('#InboxMsg').css('overflow','auto');
      $('#contactList').css('height',$('#InboxMsg').css('height'));
      $('#contactList').css('overflow','auto');

      focusUltimo();
      /*
      ultimoMsg.css('background-color','#EEE');
      setTimeout(function(){
        ultimoMsg.css('background-color','#FFF');
      },2000);*/
      /*
      cargarNotificacionesCondicional();

      $('#notifList').append('<a class="_next" href="#"></a>');
      var scroll = $('#notifList').iscroll({
        onBeginRequest:function(request){
          verTodasNotificaciones();
        }
      });*/
    });
    /*

    function cargarNotificacionesCondicional(){
        var result = verTodasNotificaciones();
        setTimeout(function(){
          if (document.getElementById('notifListTable').offsetHeight<$(window).height()){
            if (result === true){
              cargarNotificacionesCondicional();
            }
          }
        },200);
    }
    */
    function cargarInbox(name){
      $('#InboxContact').html(name);
    }
</script>
